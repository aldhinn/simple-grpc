#!/usr/bin/bash

# Update submodules
git submodule update --init --recursive

# Check if the Java output directory exists.
if [ ! -d "./grpc-api/java-impl/src/" ]; then
# If it doesn't exist, create it.
mkdir -p ./grpc-api/java-impl/src
fi

# Generate Java source code for the grpc protobuf schema.
protoc --proto_path=./grpc-api/schema \
--java_out=./grpc-api/java-impl/src \
./grpc-api/schema/*.proto

# Check if the C++ output directory exists.
if [ ! -d "./grpc-api/cpp-impl/src/schema/" ]; then
# If it doesn't exist, create it.
mkdir -p ./grpc-api/cpp-impl/src/schema
fi

# Generate c++ source code for the grpc protobuf schema
protoc --proto_path=./grpc-api/schema \
--cpp_out=./grpc-api/cpp-impl/src/schema \
./grpc-api/schema/*.proto
